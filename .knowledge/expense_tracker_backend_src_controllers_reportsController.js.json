{"is_source_file": true, "format": "JavaScript", "description": "This file is a JavaScript source file for a web backend, specifically a controller module for handling reports in an expense tracker application. It defines functions to fetch spending by category, income vs expense data, and a stub for listing alerts, utilizing SQL queries through a database helper.", "external_files": ["../db/pg.js"], "external_methods": ["query"], "published": ["spendingByCategory", "incomeVsExpense", "listAlerts"], "classes": [], "methods": [{"name": "coerceRange(r)", "description": "Helper to validate and normalize the 'range' parameter ('month' or 'quarter') for report queries.", "scope": "", "scopeKind": ""}, {"name": "isValidDateStr(s)", "description": "Helper to validate date string in 'YYYY-MM-DD' format.", "scope": "", "scopeKind": ""}, {"name": "buildDateWhere({ range, from, to })", "description": "Constructs SQL WHERE clause and parameters based on date range or explicit from/to dates for filtering transactions.", "scope": "", "scopeKind": ""}, {"name": "buildPagination(limitParam, offsetParam)", "description": "Creates limit and offset for pagination, clamped within specified bounds.", "scope": "", "scopeKind": ""}, {"name": "spendingByCategory(req, res, next)", "description": "Handles HTTP request to retrieve total outflow expenses per category within a date range with pagination.", "scope": "", "scopeKind": ""}, {"name": "incomeVsExpense(req, res, next)", "description": "Handles HTTP request to retrieve income versus expense summary grouped by month within a date range.", "scope": "", "scopeKind": ""}, {"name": "listAlerts(_req, res, _next)", "description": "Stub function to list alerts; currently returns an empty array.", "scope": "", "scopeKind": ""}], "calls": ["query"], "search-terms": ["reports", "spendingByCategory", "incomeVsExpense", "transaction_date filter", "category_id", "date_trunc", "current_date", "quarter", "month", "pagination", "SQL WHERE clause", "expense report", "visualization"], "state": 2, "file_id": 40, "knowledge_revision": 107, "git_revision": "609e630e6614cd592feafb55ea5fd382675844cc", "revision_history": [{"86": ""}, {"107": "609e630e6614cd592feafb55ea5fd382675844cc"}], "ctags": [{"_type": "tag", "name": "buildDateWhere", "path": "/home/kavia/workspace/code-generation/smart-expense-tracker-4468-4477/expense_tracker_backend/src/controllers/reportsController.js", "pattern": "/^function buildDateWhere({ range, from, to }) {$/", "language": "JavaScript", "kind": "function", "signature": "({ range, from, to })"}, {"_type": "tag", "name": "buildPagination", "path": "/home/kavia/workspace/code-generation/smart-expense-tracker-4468-4477/expense_tracker_backend/src/controllers/reportsController.js", "pattern": "/^function buildPagination(limitParam, offsetParam) {$/", "language": "JavaScript", "kind": "function", "signature": "(limitParam, offsetParam)"}, {"_type": "tag", "name": "coerceRange", "path": "/home/kavia/workspace/code-generation/smart-expense-tracker-4468-4477/expense_tracker_backend/src/controllers/reportsController.js", "pattern": "/^function coerceRange(r) {$/", "language": "JavaScript", "kind": "function", "signature": "(r)"}, {"_type": "tag", "name": "incomeVsExpense", "path": "/home/kavia/workspace/code-generation/smart-expense-tracker-4468-4477/expense_tracker_backend/src/controllers/reportsController.js", "pattern": "/^export async function incomeVsExpense(req, res, next) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res, next)"}, {"_type": "tag", "name": "isValidDateStr", "path": "/home/kavia/workspace/code-generation/smart-expense-tracker-4468-4477/expense_tracker_backend/src/controllers/reportsController.js", "pattern": "/^function isValidDateStr(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}, {"_type": "tag", "name": "listAlerts", "path": "/home/kavia/workspace/code-generation/smart-expense-tracker-4468-4477/expense_tracker_backend/src/controllers/reportsController.js", "pattern": "/^export async function listAlerts(_req, res, _next) {$/", "language": "JavaScript", "kind": "function", "signature": "(_req, res, _next)"}, {"_type": "tag", "name": "spendingByCategory", "path": "/home/kavia/workspace/code-generation/smart-expense-tracker-4468-4477/expense_tracker_backend/src/controllers/reportsController.js", "pattern": "/^export async function spendingByCategory(req, res, next) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res, next)"}], "hash": "376a1af755fe040bdd6e9dc533cdbb96", "format-version": 4, "code-base-name": "expense_tracker_frontend", "filename": "expense_tracker_backend/src/controllers/reportsController.js"}